// threejs.org/license
THREE.OrthographicTrackballControls=function(E,D){var t=this;var v={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=E;this.domElement=(D!==undefined)?D:document;this.enabled=true;this.screen={left:0,top:0,width:0,height:0};this.radius=0;this.rotateSpeed=1;this.zoomSpeed=1.2;this.noRotate=false;this.noZoom=false;this.noPan=false;this.noRoll=false;this.staticMoving=false;this.dynamicDampingFactor=0.2;this.keys=[65,83,68];this.target=new THREE.Vector3();var l=0.000001;var u=true;var w=v.NONE,o=v.NONE,b=new THREE.Vector3(),r=new THREE.Vector3(),k=new THREE.Vector3(),m=new THREE.Vector2(),z=new THREE.Vector2(),j=0,d=0,e=new THREE.Vector2(),y=new THREE.Vector2();this.target0=this.target.clone();this.position0=this.object.position.clone();this.up0=this.object.up.clone();this.left0=this.object.left;this.right0=this.object.right;this.top0=this.object.top;this.bottom0=this.object.bottom;var C={type:"change"};var n={type:"start"};var i={type:"end"};this.handleResize=function(){if(this.domElement===document){this.screen.left=0;this.screen.top=0;this.screen.width=window.innerWidth;this.screen.height=window.innerHeight}else{var F=this.domElement.getBoundingClientRect();var G=this.domElement.ownerDocument.documentElement;this.screen.left=F.left+window.pageXOffset-G.clientLeft;this.screen.top=F.top+window.pageYOffset-G.clientTop;this.screen.width=F.width;this.screen.height=F.height}this.radius=0.5*Math.min(this.screen.width,this.screen.height);this.left0=this.object.left;this.right0=this.object.right;this.top0=this.object.top;this.bottom0=this.object.bottom};this.handleEvent=function(F){if(typeof this[F.type]=="function"){this[F.type](F)}};var c=(function(){var F=new THREE.Vector2();return function(H,G){F.set((H-t.screen.left)/t.screen.width,(G-t.screen.top)/t.screen.height);return F}}());var a=(function(){var G=new THREE.Vector3();var F=new THREE.Vector3();var H=new THREE.Vector3();return function(J,I){H.set((J-t.screen.width*0.5-t.screen.left)/t.radius,(t.screen.height*0.5+t.screen.top-I)/t.radius,0);var K=H.length();if(t.noRoll){if(K<Math.SQRT1_2){H.z=Math.sqrt(1-K*K)}else{H.z=0.5/K}}else{if(K>1){H.normalize()}else{H.z=Math.sqrt(1-K*K)}}b.copy(t.object.position).sub(t.target);G.copy(t.object.up).setLength(H.y);G.add(F.copy(t.object.up).cross(b).setLength(H.x));G.add(b.setLength(H.z));return G}}());this.rotateCamera=(function(){var F=new THREE.Vector3(),G=new THREE.Quaternion();return function(){var H=Math.acos(r.dot(k)/r.length()/k.length());if(H){F.crossVectors(r,k).normalize();H*=t.rotateSpeed;G.setFromAxisAngle(F,-H);b.applyQuaternion(G);t.object.up.applyQuaternion(G);k.applyQuaternion(G);if(t.staticMoving){r.copy(k)}else{G.setFromAxisAngle(F,H*(t.dynamicDampingFactor-1));r.applyQuaternion(G)}u=true}}}());this.zoomCamera=function(){if(w===v.TOUCH_ZOOM_PAN){var F=d/j;j=d;t.object.zoom*=F;u=true}else{var F=1+(z.y-m.y)*t.zoomSpeed;if(Math.abs(F-1)>l&&F>0){t.object.zoom/=F;if(t.staticMoving){m.copy(z)}else{m.y+=(z.y-m.y)*this.dynamicDampingFactor}u=true}}};this.panCamera=(function(){var G=new THREE.Vector2(),F=new THREE.Vector3(),H=new THREE.Vector3();return function(){G.copy(y).sub(e);if(G.lengthSq()){var J=(t.object.right-t.object.left)/t.object.zoom;var I=(t.object.top-t.object.bottom)/t.object.zoom;G.x*=J;G.y*=I;H.copy(b).cross(t.object.up).setLength(G.x);H.add(F.copy(t.object.up).setLength(G.y));t.object.position.add(H);t.target.add(H);if(t.staticMoving){e.copy(y)}else{e.add(G.subVectors(y,e).multiplyScalar(t.dynamicDampingFactor))}u=true}}}());this.update=function(){b.subVectors(t.object.position,t.target);if(!t.noRotate){t.rotateCamera()}if(!t.noZoom){t.zoomCamera();if(u){t.object.updateProjectionMatrix()}}if(!t.noPan){t.panCamera()}t.object.position.addVectors(t.target,b);t.object.lookAt(t.target);if(u){t.dispatchEvent(C);u=false}};this.reset=function(){w=v.NONE;o=v.NONE;t.target.copy(t.target0);t.object.position.copy(t.position0);t.object.up.copy(t.up0);b.subVectors(t.object.position,t.target);t.object.left=t.left0;t.object.right=t.right0;t.object.top=t.top0;t.object.bottom=t.bottom0;t.object.lookAt(t.target);t.dispatchEvent(C);u=false};function h(F){if(t.enabled===false){return}window.removeEventListener("keydown",h);o=w;if(w!==v.NONE){return}else{if(F.keyCode===t.keys[v.ROTATE]&&!t.noRotate){w=v.ROTATE}else{if(F.keyCode===t.keys[v.ZOOM]&&!t.noZoom){w=v.ZOOM}else{if(F.keyCode===t.keys[v.PAN]&&!t.noPan){w=v.PAN}}}}}function f(F){if(t.enabled===false){return}w=o;window.addEventListener("keydown",h,false)}function q(F){if(t.enabled===false){return}F.preventDefault();F.stopPropagation();if(w===v.NONE){w=F.button}if(w===v.ROTATE&&!t.noRotate){r.copy(a(F.pageX,F.pageY));k.copy(r)}else{if(w===v.ZOOM&&!t.noZoom){m.copy(c(F.pageX,F.pageY));z.copy(m)}else{if(w===v.PAN&&!t.noPan){e.copy(c(F.pageX,F.pageY));y.copy(e)}}}document.addEventListener("mousemove",A,false);document.addEventListener("mouseup",s,false);t.dispatchEvent(n)}function A(F){if(t.enabled===false){return}F.preventDefault();F.stopPropagation();if(w===v.ROTATE&&!t.noRotate){k.copy(a(F.pageX,F.pageY))}else{if(w===v.ZOOM&&!t.noZoom){z.copy(c(F.pageX,F.pageY))}else{if(w===v.PAN&&!t.noPan){y.copy(c(F.pageX,F.pageY))}}}}function s(F){if(t.enabled===false){return}F.preventDefault();F.stopPropagation();w=v.NONE;document.removeEventListener("mousemove",A);document.removeEventListener("mouseup",s);t.dispatchEvent(i)}function p(F){if(t.enabled===false){return}F.preventDefault();F.stopPropagation();var G=0;if(F.wheelDelta){G=F.wheelDelta/40}else{if(F.detail){G=-F.detail/3}}m.y+=G*0.01;t.dispatchEvent(n);t.dispatchEvent(i)}function x(I){if(t.enabled===false){return}switch(I.touches.length){case 1:w=v.TOUCH_ROTATE;r.copy(a(I.touches[0].pageX,I.touches[0].pageY));k.copy(r);break;case 2:w=v.TOUCH_ZOOM_PAN;var H=I.touches[0].pageX-I.touches[1].pageX;var G=I.touches[0].pageY-I.touches[1].pageY;d=j=Math.sqrt(H*H+G*G);var F=(I.touches[0].pageX+I.touches[1].pageX)/2;var J=(I.touches[0].pageY+I.touches[1].pageY)/2;e.copy(c(F,J));y.copy(e);break;default:w=v.NONE}t.dispatchEvent(n)}function g(I){if(t.enabled===false){return}I.preventDefault();I.stopPropagation();switch(I.touches.length){case 1:k.copy(a(I.touches[0].pageX,I.touches[0].pageY));break;case 2:var H=I.touches[0].pageX-I.touches[1].pageX;var G=I.touches[0].pageY-I.touches[1].pageY;d=Math.sqrt(H*H+G*G);var F=(I.touches[0].pageX+I.touches[1].pageX)/2;var J=(I.touches[0].pageY+I.touches[1].pageY)/2;y.copy(c(F,J));break;default:w=v.NONE}}function B(G){if(t.enabled===false){return}switch(G.touches.length){case 1:k.copy(a(G.touches[0].pageX,G.touches[0].pageY));r.copy(k);break;case 2:j=d=0;var F=(G.touches[0].pageX+G.touches[1].pageX)/2;var H=(G.touches[0].pageY+G.touches[1].pageY)/2;y.copy(c(F,H));e.copy(y);break}w=v.NONE;t.dispatchEvent(i)}this.domElement.addEventListener("contextmenu",function(F){F.preventDefault()},false);this.domElement.addEventListener("mousedown",q,false);this.domElement.addEventListener("mousewheel",p,false);this.domElement.addEventListener("DOMMouseScroll",p,false);this.domElement.addEventListener("touchstart",x,false);this.domElement.addEventListener("touchend",B,false);this.domElement.addEventListener("touchmove",g,false);window.addEventListener("keydown",h,false);window.addEventListener("keyup",f,false);this.handleResize();this.update()};THREE.OrthographicTrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype);THREE.OrthographicTrackballControls.prototype.constructor=THREE.OrthographicTrackballControls;